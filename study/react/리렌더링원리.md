### React useState 리렌더링
- 효율적으로 렌더링하기 위해 여러 개의 상태값 변경 요청을 배치로 처리
---

```jsx
컴포넌트 리렌더링(X)
const [myState, setState] = useState(0);


컴포넌트 리렌더링(O)
const [myState, setState] = useState(0);
setState(1);
```

---

##### setState n번 호출하면 렌더링 몇번 발생할까?
* 단 한 번만 렌더링 된다.
```jsx

const [myState, setState] = useState(0);
setState(1);
setState(2);
setState(3);
...
setState(100);
```

---

##### 어떻게 한번에 업데이트를 할까?
- dispatchSetState 구현체를 사용한다.
- requestUpdateLane에서 업데이트 우선순위를 찾는다.
- 



---

##### 첫 번째 인자를 넘겨주면 setState는 동기적으로 동작한다.

```jsx
const [count, setCount] = useState(0)

const upState = () => {
    setCount(pv => pv+1)
    console.log('1 ', count); // 0이지만 렌더링 되고 난 후, 3
    setCount(pv => pv+1)
    console.log('2 ', count); // 0이지만 렌더링 되고 난 후, 3
    setCount(pv => pv+1)
    console.log('3 ', count); // 0이지만 렌더링 되고 난 후, 3
};

return (
    <main className="card">
        {/* <button onClick={() => setCount((count) => count + 1)}> */}
        <button onClick={() => upState()}>
        count is {count}
        </button>
    </main>
)
```

---

##### 다음과 같이 첫 번째 인자를 넘기지 않는 것과, 넘기는 것이 공존한다면?
- 첫 번째 인자를 넘기지 않는 setState에서 초기화 한다.

```jsx
const [count, setCount] = useState(0)

const upState = () => {
    setCount(count + 1); // 이곳에서 초기화 발생!
    console.log('1', count) // 0이지만 렌더링 되고 난 후, 4
    setCount(pv => pv+1)
    console.log('2 ', count); // 0이지만 렌더링 되고 난 후, 4
    setCount(pv => pv+1)
    console.log('3 ', count); // 0이지만 렌더링 되고 난 후, 4
    setCount(pv => pv+1)
    console.log('4 ', count); // 0이지만 렌더링 되고 난 후, 4
};

return (
    <main className="card">
        {/* <button onClick={() => setCount((count) => count + 1)}> */}
        <button onClick={() => upState()}>
        count is {count}
        </button>
    </main>
)
```

---


##### 다음과 같이 첫 번째 인자를 넘기지 않는 것과, 넘기는 것이 공존한다면?(2)
- 첫 번째 인자를 넘기지 않는 setState에서 초기화 한다.
```jsx
const [count, setCount] = useState(0)

const upState = () => {
    setCount(count + 1); // 이곳에서 초기화 발생!
    console.log('1', count) // 0이지만 렌더링 되고 난 후, 2
    setCount(pv => pv+1)
    console.log('2 ', count); // 0이지만 렌더링 되고 난 후, 2
    setCount(pv => pv+1)
    console.log('3 ', count); // 0이지만 렌더링 되고 난 후, 2
    setCount(count + 1);   // 이곳에서 초기화 발생!
    console.log('4', count) // 0이지만 렌더링 되고 난 후, 2
    setCount(pv => pv+1)
    console.log('5 ', count); // 0이지만 렌더링 되고 난 후, 2
};

return (
    <main className="card">
        {/* <button onClick={() => setCount((count) => count + 1)}> */}
        <button onClick={() => upState()}>
        count is {count}
        </button>
    </main>
)
```